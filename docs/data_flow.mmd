flowchart TD
  ecommerce_orders[ecommerce.orders]
  ecommerce_customers[ecommerce.customers]

  sql_01{{01_extract_recent_orders.sql}}

  ecommerce_recent_orders[ecommerce.recent_orders]

  sql_02{{02_join_orders_customers.sql}}

  ecommerce_orders_with_customers[ecommerce.orders_with_customers]

  sql_03{{03_aggregate_revenue_by_tier.sql}}

  ecommerce_daily_revenue_by_tier[ecommerce.daily_revenue_by_tier]
  ecommerce_loyalty_tier_targets[ecommerce.loyalty_tier_targets]

  ecommerce_orders --> sql_01
  sql_01 --> ecommerce_recent_orders
  ecommerce_recent_orders --> sql_02
  ecommerce_customers --> sql_02
  sql_02 --> ecommerce_orders_with_customers
  ecommerce_orders_with_customers --> sql_03
  ecommerce_loyalty_tier_targets --> sql_03
  sql_03 --> ecommerce_daily_revenue_by_tier

  style sql_01 fill:#e6f3ff,stroke:#0066cc,stroke-width:2px
  style sql_02 fill:#e6f3ff,stroke:#0066cc,stroke-width:2px
  style sql_03 fill:#e6f3ff,stroke:#0066cc,stroke-width:2px

  style ecommerce_orders fill:#ffffff,stroke:#333333,stroke-width:1px
  style ecommerce_customers fill:#ffffff,stroke:#333333,stroke-width:1px
  style ecommerce_recent_orders fill:#ffffff,stroke:#333333,stroke-width:1px
  style ecommerce_orders_with_customers fill:#ffffff,stroke:#333333,stroke-width:1px
  style ecommerce_daily_revenue_by_tier fill:#ffffff,stroke:#333333,stroke-width:1px
  style ecommerce_loyalty_tier_targets fill:#ffffff,stroke:#333333,stroke-width:1px


